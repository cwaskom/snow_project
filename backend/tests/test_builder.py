from app import builder

test_data = [{'dt': 1613347200, 'main': {'temp': 44.01, 'feels_like': 35.87, 'temp_min': 39.61, 'temp_max': 44.01, 'pressure': 1024, 'sea_level': 1024, 'grnd_level': 902, 'humidity': 56, 'temp_kf': 2.44}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'clouds': {'all': 80}, 'wind': {'speed': 7.45, 'deg': 21}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2021-02-15 00:00:00'}, {'dt': 1613358000, 'main': {'temp': 41.34, 'feels_like': 33.13, 'temp_min': 39.45, 'temp_max': 41.34, 'pressure': 1026, 'sea_level': 1026, 'grnd_level': 902, 'humidity': 62, 'temp_kf': 1.05}, 'weather': [{'id': 601, 'main': 'Clouds', 'description': 'test snow', 'icon': '03d'}], 'clouds': {'all': 42}, 'wind': {'speed': 7.56, 'deg': 22}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2021-02-15 03:00:00'}, {'dt': 1613368800, 'main': {'temp': 48.65, 'feels_like': 40.87, 'temp_min': 48.65, 'temp_max': 48.69, 'pressure': 1024, 'sea_level': 1024, 'grnd_level': 902, 'humidity': 46, 'temp_kf': -0.02}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02d'}], 'clouds': {'all': 21}, 'wind': {'speed': 6.69, 'deg': 32}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2021-02-15 06:00:00'}, {'dt': 1613379600, 'main': {'temp': 52.43, 'feels_like': 44.91, 'temp_min': 52.43, 'temp_max': 52.47, 'pressure': 1022, 'sea_level': 1022, 'grnd_level': 901, 'humidity': 40, 'temp_kf': -0.02}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01d'}], 'clouds': {'all': 1}, 'wind': {'speed': 6.24, 'deg': 40}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2021-02-15 09:00:00'}, {'dt': 1613390400, 'main': {'temp': 49.01, 'feels_like': 41.97, 'temp_min': 49.01, 'temp_max': 49.01, 'pressure': 1022, 'sea_level': 1022, 'grnd_level': 901, 'humidity': 47, 'temp_kf': 0}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01d'}], 'clouds': {'all': 0}, 'wind': {'speed': 5.57, 'deg': 33}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2021-02-15 12:00:00'}, {'dt': 1613401200, 'main': {'temp': 42.57, 'feels_like': 33.96, 'temp_min': 42.57, 'temp_max': 42.57, 'pressure': 1024, 'sea_level': 1024, 'grnd_level': 901, 'humidity': 59, 'temp_kf': 0}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'clouds': {'all': 46}, 'wind': {'speed': 8.25, 'deg': 22}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2021-02-15 15:00:00'}, {'dt': 1613412000, 'main': {'temp': 41.09, 'feels_like': 32.38, 'temp_min': 41.09, 'temp_max': 41.09, 'pressure': 1024, 'sea_level': 1024, 'grnd_level': 901, 'humidity': 61, 'temp_kf': 0}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'clouds': {'all': 68}, 'wind': {'speed': 8.32, 'deg': 22}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2021-02-15 18:00:00'}, {'dt': 1613422800, 'main': {'temp': 39.69, 'feels_like': 31.03, 'temp_min': 39.69, 'temp_max': 39.69, 'pressure': 1024, 'sea_level': 1024, 'grnd_level': 900, 'humidity': 63, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 94}, 'wind': {'speed': 8.08, 'deg': 24}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2021-02-15 21:00:00'}]
test_clean_data = [{'date': '02-14-2021 19:00:00', 'weather': 601, 'description': 'test snow', 'temp': 44.01, 'pop': 0}, {'date': '02-14-2021 19:00:00', 'weather': 603, 'description': 'heavy test snow', 'temp': 44.01, 'pop': 0}, {'date': '02-14-2021 19:00:00', 'weather': 803, 'description': 'partial clouds', 'temp': 44.01, 'pop': 0}]

def test_build_weather():
    clean_weather = builder.build_weather(test_data)
    assert clean_weather[0] == {'date': '02-14-2021 19:00:00', 'weather': 803, 'description': 'broken clouds', 'temp': 44.01, 'pop': 0}

def test_find_snow():
    snow_days = builder.find_snow(test_clean_data)
    assert snow_days[0]['weather'] == 601